<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜ | æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect</title>
<meta name="keywords" content="">
<meta name="description" content="
ğŸ¯ æ’æŸ¥ç›®æ ‡
å®šä½ Java åº”ç”¨ä¸­ æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚

ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯”

  
      
          å‘½ä»¤
          ä½œç”¨
          ä½¿ç”¨åœºæ™¯
      
  
  
      
          trace
          è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶
          å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ
      
      
          watch
          è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶
          æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ
      
      
          monitor
          ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡
          è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½
      
      
          tt
          æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾
          ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„
      
      
          profiler
          CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰
          å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰
      
  


ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹
Step 1ï¸âƒ£ï¼šç”¨Â 
monitor
Â çœ‹å“ªä¸ªæ–¹æ³•æ…¢
monitor -c 5 com.example.service.OrderService placeOrder
æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚">
<meta name="author" content="å°¹ç»é’§">
<link rel="canonical" href="https://yinshaojun001.github.io/posts/arthas%E6%8E%92%E6%9F%A5/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://yinshaojun001.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://yinshaojun001.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yinshaojun001.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://yinshaojun001.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://yinshaojun001.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://yinshaojun001.github.io/posts/arthas%E6%8E%92%E6%9F%A5/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://yinshaojun001.github.io/posts/arthas%E6%8E%92%E6%9F%A5/">
  <meta property="og:site_name" content="æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect">
  <meta property="og:title" content="Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜">
  <meta property="og:description" content=" ğŸ¯ æ’æŸ¥ç›®æ ‡ å®šä½ Java åº”ç”¨ä¸­ æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚
ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯” å‘½ä»¤ ä½œç”¨ ä½¿ç”¨åœºæ™¯ trace è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶ å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ watch è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶ æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ monitor ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡ è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½ tt æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾ ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„ profiler CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰ å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰ ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹ Step 1ï¸âƒ£ï¼šç”¨Â monitor çœ‹å“ªä¸ªæ–¹æ³•æ…¢ monitor -c 5 com.example.service.OrderService placeOrder æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-07-25T17:34:25+08:00">
    <meta property="article:modified_time" content="2025-07-25T17:34:25+08:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜">
<meta name="twitter:description" content="
ğŸ¯ æ’æŸ¥ç›®æ ‡
å®šä½ Java åº”ç”¨ä¸­ æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚

ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯”

  
      
          å‘½ä»¤
          ä½œç”¨
          ä½¿ç”¨åœºæ™¯
      
  
  
      
          trace
          è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶
          å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ
      
      
          watch
          è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶
          æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ
      
      
          monitor
          ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡
          è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½
      
      
          tt
          æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾
          ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„
      
      
          profiler
          CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰
          å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰
      
  


ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹
Step 1ï¸âƒ£ï¼šç”¨Â 
monitor
Â çœ‹å“ªä¸ªæ–¹æ³•æ…¢
monitor -c 5 com.example.service.OrderService placeOrder
æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://yinshaojun001.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜",
      "item": "https://yinshaojun001.github.io/posts/arthas%E6%8E%92%E6%9F%A5/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜",
  "name": "Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜",
  "description": " ğŸ¯ æ’æŸ¥ç›®æ ‡ å®šä½ Java åº”ç”¨ä¸­ æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚\nğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯” å‘½ä»¤ ä½œç”¨ ä½¿ç”¨åœºæ™¯ trace è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶ å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ watch è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶ æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ monitor ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡ è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½ tt æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾ ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„ profiler CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰ å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰ ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹ Step 1ï¸âƒ£ï¼šç”¨Â monitor çœ‹å“ªä¸ªæ–¹æ³•æ…¢ monitor -c 5 com.example.service.OrderService placeOrder æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚\n",
  "keywords": [
    
  ],
  "articleBody": " ğŸ¯ æ’æŸ¥ç›®æ ‡ å®šä½ Java åº”ç”¨ä¸­ æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚\nğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯” å‘½ä»¤ ä½œç”¨ ä½¿ç”¨åœºæ™¯ trace è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶ å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ watch è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶ æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ monitor ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡ è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½ tt æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾ ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„ profiler CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰ å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰ ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹ Step 1ï¸âƒ£ï¼šç”¨Â monitor çœ‹å“ªä¸ªæ–¹æ³•æ…¢ monitor -c 5 com.example.service.OrderService placeOrder æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚\nStep 2ï¸âƒ£ï¼šç”¨Â trace çœ‹æ…¢åœ¨å“ªä¸€æ­¥ trace com.example.service.OrderService placeOrder è¾“å‡ºæ ·ä¾‹ï¼š\n`---[10530ms] OrderService.placeOrder() +---[80% 8424ms] PaymentService.charge() +---[15% 1575ms] InventoryService.check() ğŸ” å®šä½ PaymentService.charge() æœ€æ…¢\nStep 3ï¸âƒ£ï¼šæ·±å…¥Â trace å­æ–¹æ³• trace com.example.payment.PaymentService charge ç»§ç»­åˆ†æ charge() æ–¹æ³•ä¸­ï¼Œæ˜¯å¦æ•°æ®åº“ã€è¿œç¨‹è°ƒç”¨ã€è®¡ç®—ç­‰è€—æ—¶ã€‚\nStep 4ï¸âƒ£ï¼šç”¨Â watch çœ‹æ–¹æ³•å…¥å‚ + è€—æ—¶ watch com.example.payment.PaymentService charge '{params, returnObj, cost}' -x 3 è¾“å‡ºï¼š\nparams[0]: Order{id=123} returnObj: Result{success=true} cost: 8423ms ğŸ“Œ å¯ä»¥ç»“åˆå‚æ•°åˆ¤æ–­å“ªäº›è®¢å•è€—æ—¶é•¿ã€‚\nStep 5ï¸âƒ£ï¼šåªåˆ†ææ…¢è¯·æ±‚ï¼ˆå¯é€‰ï¼‰ trace com.example.payment.PaymentService charge '#cost \u003e 1000' ä»…æ˜¾ç¤ºè€—æ—¶è¶…è¿‡ 1 ç§’çš„è°ƒç”¨ã€‚\nStep 6ï¸âƒ£ï¼šä½¿ç”¨Â tt å›æ”¾æŸæ¬¡æ…¢è°ƒç”¨ tt -t com.example.payment.PaymentService charge tt -l tt -i 1000 tt -w 1000 å¯ä»¥æŸ¥çœ‹å‚æ•°ã€è¿”å›å€¼ã€è°ƒç”¨å †æ ˆï¼Œéå¸¸é€‚åˆæ·±å…¥åˆ†æã€‚\nğŸ“Œ å®æˆ˜æŠ€å·§æ€»ç»“ åœºæ™¯ å·¥å…· / å‘½ä»¤ æŸä¸ªé¡µé¢æˆ–æ¥å£å“åº”æ…¢ trace é¡¶å±‚æ–¹æ³• ç»†æŸ¥å“ªä¸ªå†…éƒ¨æ–¹æ³•æœ€è€—æ—¶ trace ç»§ç»­æ·±å…¥å­æ–¹æ³• çœ‹å‚æ•°å’Œè¿”å›å€¼ + è€—æ—¶ watch å¤§é‡æ•°æ®æ—¶ï¼Œå¹³å‡è€—æ—¶é•¿ monitor å¤šæ¬¡æ…¢è°ƒç”¨ï¼Œç²¾ç¡®é‡æ”¾åˆ†æ tt ä¸ç¡®å®šä»£ç åœ¨å“ªæ‰§è¡Œ jad + search-class + sc âœ… é™„åŠ å‘½ä»¤å°æŠ„ # æŸ¥æ‰¾ç±» sc -d *OrderService # åç¼–è¯‘ç±» jad com.example.service.OrderService # æŸ¥çœ‹æ‰€æœ‰åŠ è½½ç±» sc -d # æŸ¥çœ‹æ–¹æ³•è€—æ—¶æ’åº profiler start profiler stop ğŸ§  ä¼˜åŒ–å»ºè®®æ–¹å‘ æ˜¯å¦æœ‰æ…¢ SQLï¼šå¯ç»“åˆæ—¥å¿—ã€SQL åˆ†æå·¥å…·æŸ¥çœ‹\næ˜¯å¦é‡å¤è¿œç¨‹è°ƒç”¨ï¼šåŠ ç¼“å­˜ã€èšåˆè¯·æ±‚\næ˜¯å¦çº¿ç¨‹æ± /å¹¶è¡Œæœªç”Ÿæ•ˆï¼šæ£€æŸ¥çº¿ç¨‹æ¨¡å‹\næ˜¯å¦ GC é¢‘ç¹ï¼šç»“åˆ jvm æŸ¥çœ‹å†…å­˜æƒ…å†µ\nğŸ å°ç»“ å·¥å…·ç»„åˆ ç”¨é€” monitor + trace æ‰¾æ…¢æ–¹æ³• + æ…¢æ­¥éª¤ trace + watch æ‰¾æ…¢æ­¥éª¤ + çœ‹å…¥å‚ç»“æœ trace + tt æ‰¾è°ƒç”¨é“¾ + ç²¾å‡†å›æ”¾ ",
  "wordCount" : "718",
  "inLanguage": "zh",
  "datePublished": "2025-07-25T17:34:25+08:00",
  "dateModified": "2025-07-25T17:34:25+08:00",
  "author":{
    "@type": "Person",
    "name": "å°¹ç»é’§"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://yinshaojun001.github.io/posts/arthas%E6%8E%92%E6%9F%A5/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect",
    "logo": {
      "@type": "ImageObject",
      "url": "https://yinshaojun001.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://yinshaojun001.github.io/" accesskey="h" title="æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect (Alt + H)">æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://yinshaojun001.github.io/" title="é¦–é¡µ">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://yinshaojun001.github.io/posts/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://yinshaojun001.github.io/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Arthas å®æˆ˜æ•™ç¨‹ï¼šæ’æŸ¥ Java ä»£ç æ‰§è¡Œç¼“æ…¢é—®é¢˜
    </h1>
    <div class="post-meta"><span title='2025-07-25 17:34:25 +0800 CST'>ä¸ƒæœˆ 25, 2025</span>&nbsp;Â·&nbsp;å°¹ç»é’§

</div>
  </header> 
  <div class="post-content"><hr>
<h2 id="-æ’æŸ¥ç›®æ ‡"><strong>ğŸ¯ æ’æŸ¥ç›®æ ‡</strong><a hidden class="anchor" aria-hidden="true" href="#-æ’æŸ¥ç›®æ ‡">#</a></h2>
<p>å®šä½ Java åº”ç”¨ä¸­ <strong>æ‰§è¡Œç¼“æ…¢çš„ä»£ç æ®µ</strong>ï¼Œæ‰¾å‡ºæ–¹æ³•è€—æ—¶æœ€é•¿çš„åœ°æ–¹ï¼Œå¸®åŠ©æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<hr>
<h2 id="-å¸¸ç”¨å‘½ä»¤å¯¹æ¯”"><strong>ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤å¯¹æ¯”</strong><a hidden class="anchor" aria-hidden="true" href="#-å¸¸ç”¨å‘½ä»¤å¯¹æ¯”">#</a></h2>
<table>
  <thead>
      <tr>
          <th><strong>å‘½ä»¤</strong></th>
          <th><strong>ä½œç”¨</strong></th>
          <th><strong>ä½¿ç”¨åœºæ™¯</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>trace</td>
          <td>è¿½è¸ªæ–¹æ³•å†…éƒ¨æ¯ä¸€æ­¥æ‰§è¡Œè€—æ—¶</td>
          <td>å®šä½æ…¢æ­¥éª¤ã€æ–¹æ³•è€—æ—¶åˆ†å¸ƒ</td>
      </tr>
      <tr>
          <td>watch</td>
          <td>è§‚å¯Ÿæ–¹æ³•å…¥å‚ã€è¿”å›å€¼ã€æ‰§è¡Œè€—æ—¶</td>
          <td>æŸ¥çœ‹è°ƒç”¨æƒ…å†µåŠç»“æœ</td>
      </tr>
      <tr>
          <td>monitor</td>
          <td>ç»Ÿè®¡æ–¹æ³•çš„ QPSã€å¹³å‡è€—æ—¶ã€å¤±è´¥ç‡</td>
          <td>è§‚å¯Ÿæ–¹æ³•æ•´ä½“æ€§èƒ½</td>
      </tr>
      <tr>
          <td>tt</td>
          <td>æ–¹æ³•è°ƒç”¨è®°å½•å¿«ç…§ï¼Œå¯å›æ”¾</td>
          <td>ç²¾ç¡®åˆ†ææ…¢è°ƒç”¨å‚æ•°ä¸è·¯å¾„</td>
      </tr>
      <tr>
          <td>profiler</td>
          <td>CPU çº§åˆ«é‡‡æ ·ï¼Œé€‚åˆæŸ¥æ‰¾çƒ­ç‚¹ï¼ˆæ›´åº•å±‚ï¼‰</td>
          <td>å¤§èŒƒå›´æ€§èƒ½ç“¶é¢ˆåˆ†æï¼ˆéå•æ–¹æ³•ï¼‰</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-æ’æŸ¥æµç¨‹ç¤ºä¾‹"><strong>ğŸ” æ’æŸ¥æµç¨‹ç¤ºä¾‹</strong><a hidden class="anchor" aria-hidden="true" href="#-æ’æŸ¥æµç¨‹ç¤ºä¾‹">#</a></h2>
<h3 id="step-1ç”¨"><strong>Step 1ï¸âƒ£ï¼šç”¨</strong>Â <a hidden class="anchor" aria-hidden="true" href="#step-1ç”¨">#</a></h3>
<h3 id="monitor"><strong>monitor</strong><a hidden class="anchor" aria-hidden="true" href="#monitor">#</a></h3>
<h3 id="çœ‹å“ªä¸ªæ–¹æ³•æ…¢">Â <strong>çœ‹å“ªä¸ªæ–¹æ³•æ…¢</strong><a hidden class="anchor" aria-hidden="true" href="#çœ‹å“ªä¸ªæ–¹æ³•æ…¢">#</a></h3>
<pre tabindex="0"><code>monitor -c 5 com.example.service.OrderService placeOrder
</code></pre><p>æŸ¥çœ‹æœ€è¿‘ 5 æ¬¡è°ƒç”¨ç»Ÿè®¡ï¼ŒåŒ…å«å¹³å‡è€—æ—¶ï¼ˆavg-rtï¼‰ã€‚</p>
<hr>
<h3 id="step-2ç”¨"><strong>Step 2ï¸âƒ£ï¼šç”¨</strong>Â <a hidden class="anchor" aria-hidden="true" href="#step-2ç”¨">#</a></h3>
<h3 id="trace"><strong>trace</strong><a hidden class="anchor" aria-hidden="true" href="#trace">#</a></h3>
<h3 id="çœ‹æ…¢åœ¨å“ªä¸€æ­¥">Â <strong>çœ‹æ…¢åœ¨å“ªä¸€æ­¥</strong><a hidden class="anchor" aria-hidden="true" href="#çœ‹æ…¢åœ¨å“ªä¸€æ­¥">#</a></h3>
<pre tabindex="0"><code>trace com.example.service.OrderService placeOrder
</code></pre><p>è¾“å‡ºæ ·ä¾‹ï¼š</p>
<pre tabindex="0"><code>`---[10530ms] OrderService.placeOrder()
    +---[80% 8424ms] PaymentService.charge()
    +---[15% 1575ms] InventoryService.check()
</code></pre><p>ğŸ” <strong>å®šä½ PaymentService.charge() æœ€æ…¢</strong></p>
<hr>
<h3 id="step-3æ·±å…¥"><strong>Step 3ï¸âƒ£ï¼šæ·±å…¥</strong>Â <a hidden class="anchor" aria-hidden="true" href="#step-3æ·±å…¥">#</a></h3>
<h3 id="trace-1"><strong>trace</strong><a hidden class="anchor" aria-hidden="true" href="#trace-1">#</a></h3>
<h3 id="å­æ–¹æ³•">Â <strong>å­æ–¹æ³•</strong><a hidden class="anchor" aria-hidden="true" href="#å­æ–¹æ³•">#</a></h3>
<pre tabindex="0"><code>trace com.example.payment.PaymentService charge
</code></pre><p>ç»§ç»­åˆ†æ charge() æ–¹æ³•ä¸­ï¼Œæ˜¯å¦æ•°æ®åº“ã€è¿œç¨‹è°ƒç”¨ã€è®¡ç®—ç­‰è€—æ—¶ã€‚</p>
<hr>
<h3 id="step-4ç”¨"><strong>Step 4ï¸âƒ£ï¼šç”¨</strong>Â <a hidden class="anchor" aria-hidden="true" href="#step-4ç”¨">#</a></h3>
<h3 id="watch"><strong>watch</strong><a hidden class="anchor" aria-hidden="true" href="#watch">#</a></h3>
<h3 id="çœ‹æ–¹æ³•å…¥å‚--è€—æ—¶">Â <strong>çœ‹æ–¹æ³•å…¥å‚ + è€—æ—¶</strong><a hidden class="anchor" aria-hidden="true" href="#çœ‹æ–¹æ³•å…¥å‚--è€—æ—¶">#</a></h3>
<pre tabindex="0"><code>watch com.example.payment.PaymentService charge &#39;{params, returnObj, cost}&#39; -x 3
</code></pre><p>è¾“å‡ºï¼š</p>
<pre tabindex="0"><code>params[0]: Order{id=123}
returnObj: Result{success=true}
cost: 8423ms
</code></pre><p>ğŸ“Œ å¯ä»¥ç»“åˆå‚æ•°åˆ¤æ–­å“ªäº›è®¢å•è€—æ—¶é•¿ã€‚</p>
<hr>
<h3 id="step-5åªåˆ†ææ…¢è¯·æ±‚å¯é€‰"><strong>Step 5ï¸âƒ£ï¼šåªåˆ†ææ…¢è¯·æ±‚ï¼ˆå¯é€‰ï¼‰</strong><a hidden class="anchor" aria-hidden="true" href="#step-5åªåˆ†ææ…¢è¯·æ±‚å¯é€‰">#</a></h3>
<pre tabindex="0"><code>trace com.example.payment.PaymentService charge &#39;#cost &gt; 1000&#39;
</code></pre><p>ä»…æ˜¾ç¤ºè€—æ—¶è¶…è¿‡ 1 ç§’çš„è°ƒç”¨ã€‚</p>
<hr>
<h3 id="step-6ä½¿ç”¨"><strong>Step 6ï¸âƒ£ï¼šä½¿ç”¨</strong>Â <a hidden class="anchor" aria-hidden="true" href="#step-6ä½¿ç”¨">#</a></h3>
<h3 id="tt"><strong>tt</strong><a hidden class="anchor" aria-hidden="true" href="#tt">#</a></h3>
<h3 id="å›æ”¾æŸæ¬¡æ…¢è°ƒç”¨">Â <strong>å›æ”¾æŸæ¬¡æ…¢è°ƒç”¨</strong><a hidden class="anchor" aria-hidden="true" href="#å›æ”¾æŸæ¬¡æ…¢è°ƒç”¨">#</a></h3>
<pre tabindex="0"><code>tt -t com.example.payment.PaymentService charge
tt -l
tt -i 1000
tt -w 1000
</code></pre><p>å¯ä»¥æŸ¥çœ‹å‚æ•°ã€è¿”å›å€¼ã€è°ƒç”¨å †æ ˆï¼Œéå¸¸é€‚åˆæ·±å…¥åˆ†æã€‚</p>
<hr>
<h2 id="-å®æˆ˜æŠ€å·§æ€»ç»“"><strong>ğŸ“Œ å®æˆ˜æŠ€å·§æ€»ç»“</strong><a hidden class="anchor" aria-hidden="true" href="#-å®æˆ˜æŠ€å·§æ€»ç»“">#</a></h2>
<table>
  <thead>
      <tr>
          <th><strong>åœºæ™¯</strong></th>
          <th><strong>å·¥å…· / å‘½ä»¤</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>æŸä¸ªé¡µé¢æˆ–æ¥å£å“åº”æ…¢</td>
          <td>trace é¡¶å±‚æ–¹æ³•</td>
      </tr>
      <tr>
          <td>ç»†æŸ¥å“ªä¸ªå†…éƒ¨æ–¹æ³•æœ€è€—æ—¶</td>
          <td>trace ç»§ç»­æ·±å…¥å­æ–¹æ³•</td>
      </tr>
      <tr>
          <td>çœ‹å‚æ•°å’Œè¿”å›å€¼ + è€—æ—¶</td>
          <td>watch</td>
      </tr>
      <tr>
          <td>å¤§é‡æ•°æ®æ—¶ï¼Œå¹³å‡è€—æ—¶é•¿</td>
          <td>monitor</td>
      </tr>
      <tr>
          <td>å¤šæ¬¡æ…¢è°ƒç”¨ï¼Œç²¾ç¡®é‡æ”¾åˆ†æ</td>
          <td>tt</td>
      </tr>
      <tr>
          <td>ä¸ç¡®å®šä»£ç åœ¨å“ªæ‰§è¡Œ</td>
          <td>jad + search-class + sc</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-é™„åŠ å‘½ä»¤å°æŠ„"><strong>âœ… é™„åŠ å‘½ä»¤å°æŠ„</strong><a hidden class="anchor" aria-hidden="true" href="#-é™„åŠ å‘½ä»¤å°æŠ„">#</a></h2>
<pre tabindex="0"><code># æŸ¥æ‰¾ç±»
sc -d *OrderService

# åç¼–è¯‘ç±»
jad com.example.service.OrderService

# æŸ¥çœ‹æ‰€æœ‰åŠ è½½ç±»
sc -d

# æŸ¥çœ‹æ–¹æ³•è€—æ—¶æ’åº
profiler start
profiler stop
</code></pre><hr>
<h2 id="-ä¼˜åŒ–å»ºè®®æ–¹å‘"><strong>ğŸ§  ä¼˜åŒ–å»ºè®®æ–¹å‘</strong><a hidden class="anchor" aria-hidden="true" href="#-ä¼˜åŒ–å»ºè®®æ–¹å‘">#</a></h2>
<ul>
<li>
<p>æ˜¯å¦æœ‰æ…¢ SQLï¼šå¯ç»“åˆæ—¥å¿—ã€SQL åˆ†æå·¥å…·æŸ¥çœ‹</p>
</li>
<li>
<p>æ˜¯å¦é‡å¤è¿œç¨‹è°ƒç”¨ï¼šåŠ ç¼“å­˜ã€èšåˆè¯·æ±‚</p>
</li>
<li>
<p>æ˜¯å¦çº¿ç¨‹æ± /å¹¶è¡Œæœªç”Ÿæ•ˆï¼šæ£€æŸ¥çº¿ç¨‹æ¨¡å‹</p>
</li>
<li>
<p>æ˜¯å¦ GC é¢‘ç¹ï¼šç»“åˆ jvm æŸ¥çœ‹å†…å­˜æƒ…å†µ</p>
</li>
</ul>
<hr>
<h2 id="-å°ç»“"><strong>ğŸ å°ç»“</strong><a hidden class="anchor" aria-hidden="true" href="#-å°ç»“">#</a></h2>
<table>
  <thead>
      <tr>
          <th><strong>å·¥å…·ç»„åˆ</strong></th>
          <th><strong>ç”¨é€”</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>monitor + trace</td>
          <td>æ‰¾æ…¢æ–¹æ³• + æ…¢æ­¥éª¤</td>
      </tr>
      <tr>
          <td>trace + watch</td>
          <td>æ‰¾æ…¢æ­¥éª¤ + çœ‹å…¥å‚ç»“æœ</td>
      </tr>
      <tr>
          <td>trace + tt</td>
          <td>æ‰¾è°ƒç”¨é“¾ + ç²¾å‡†å›æ”¾</td>
      </tr>
  </tbody>
</table>
<hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://yinshaojun001.github.io/">æ—¥æ‹±ä¸€å’ï¼ŒDone is better than perfect</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
